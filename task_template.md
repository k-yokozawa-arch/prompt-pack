改訂版 3) タスク用“ユーザープロンプト”テンプレ（v2）
【ゴール】
* 何を：{例：電帳法アーカイブの「監査ZIP生成」機能}
* 誰のために：{経理/監査人}
* KPI：{例：監査抽出30分→2分、失敗率<1%}
* コスト前提：{例：月¥○○以内/1テナント}
【制約/前提】
* Contract-first：OpenAPI 3.1で定義→型/クライアント生成（oapi-codegen/openapi-typescript）。
* スタックは固定しない（実例は TS or Go のいずれか）。
* 設定は .env / 環境変数から注入（ハードコード禁止）。
* Platform前提（Tenant/RBAC/監査ログ/ジョブ/検索）。
* UIは a11y 準拠、Loading/Empty/Error を設計、PWA（再送キュー）。
* i18n/タイムゾーン（初期値：ja-JP/Asia/Tokyo）。
【入出力仕様（契約）】
* 入力：{例：期間from/to、取引先、出力形式=zip}
* 出力：{例：ジョブID、進捗、完了時のS3キー（署名URL）}
* エラーモデル：{400検証、403認可、409競合、500内部}
* 監査ログ：{誰が/いつ/何を} を append-only＋ハッシュチェーンに記録。
【やってほしいこと（順序）】
1. 仕様要約（不足は仮定を明記、SLO/コスト前提も）
2. OpenAPI契約/型定義（3.1／TypeBox/ZodいずれかもOK）
3. 実装（設定注入・構造化ロギングcorrId/tenantId・例外ハンドリング・生成コマンド）
4. UI（フォーム/プログレス/完了表示、kbd操作、PWA再送）
5. テスト（正常/失敗/境界、仕様差分JSON→E2E、モック方針）
6. 自己レビューと改善案（rubric準拠）
7. 実行手順とPR本文（契約ドリフトチェックを含む）
【添付/前提ファイル（任意）】
* 仕様差分JSON：/rules/ledger/*.json または /rules/pint/*.json
* 契約パス：/apis/specs/{audit-zip.yaml|pint-validate.yaml}
【チェックリストを満たしてから回答して】









3) タスク用“ユーザープロンプト”テンプレ（毎回これで依頼）
これをコピペして、太字の穴埋めだけ変えればOK。

【ゴール】
- **何を**：{例：電帳法アーカイブの「監査ZIP生成」機能}
- **誰のために**：{経理/監査人}
- **KPI**：{監査用抽出の所要時間を30分→2分}

【制約/前提】
- インフラ/言語は固定しないで：抽象化したインターフェイスで実装。実例は TypeScript or Go いずれかでOK。
- 設定は .env / 環境変数から注入（ハードコード禁止）
- UIはアクセシビリティ遵守、ローディング/空/エラー状態を必ず設計
- 国際化(i18n)・タイムゾーン考慮（日本語/日本時間が初期値）

【入出力仕様（契約）】
- 入力：{例：期間from/to、取引先任意、出力形式=zip}
- 出力：{例：ジョブID、進捗、完了時のS3キー}
- エラーモデル：{例：400検証エラー、403認可、500内部}

【やってほしいこと（順序）】
1) 仕様要約（不足があれば仮定を明記）
2) API契約/型定義（OpenAPI or TypeBox/Zod いずれかで）
3) 実装（設定注入・ロギング・例外ハンドリングを含む）
4) UI（フォーム/プログレス/完了表示、キーボード操作可）
5) テスト（正常/失敗/境界）とモック方針
6) 自己レビューと改善案
7) 実行手順とPR本文

【チェックリストを満たしてから回答して】
